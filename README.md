# Автономная навигация БПЛА по изображению местности

## Описание проекта
Данный проект посвящён задаче автономной навигации беспилотного летательного аппарата (БПЛА) с одной камерой, направленной вниз. Основная цель — определение текущей позиции БПЛА по снимку местности. Для этого в память устройства заранее загружается глобальная карта (изображение всей местности), а программа ищет на этой карте участок, наиболее похожий на текущий снимок с камеры. Таким образом определяется положение БПЛА относительно карты.

## Преимущества использования GPU
Вычисления по поиску наиболее похожего участка на карте требуют большого количества операций сравнения изображений (например, с помощью метрики SSIM). Использование GPU (графического процессора) позволяет значительно ускорить эти вычисления за счёт параллельной обработки данных. В отличие от CPU, который выполняет задачи последовательно или с ограниченным параллелизмом, GPU может обрабатывать тысячи потоков одновременно, что особенно эффективно для задач обработки изображений.

**Результаты сравнения:**
- Время работы на GPU: **3.618 секунд**
- Время работы на CPU: **78 минут**

Это демонстрирует огромный прирост производительности при использовании GPU для подобных задач.

## Трудности с чтением PNG
В процессе работы возникли сложности с реализацией корректного чтения PNG-файлов непосредственно в CUDA-программе. Стандартные библиотеки либо отсутствовали, либо не поддерживались в нужной среде. Поэтому были созданы отдельные программы для конвертации изображений в собственный (более простой для чтения) формат, который затем использовался в основной программе.

## Запуск программыы
1. Сконвертируйте изображения карты и участка в поддерживаемый формат (см. выше).
2. Соберите и запустите CUDA-программу, передав ей пути к изображениям.

### Пример команды для запуска

```
./add_cuda Map.png Patch.png
```

Где `Map.png` — это файл с глобальной картой, а `Patch.png` — участок, позицию которого нужно определить.

---

**Проект иллюстрирует, как современные методы обработки изображений и вычисления на GPU позволяют решать задачи навигации в реальном времени.**

## Асимптотическая сложность исходного алгоритма для CPU (без распараллеливания)

Пусть:
- $W, H$ — ширина и высота карты (Map),
- $w, h$ — ширина и высота участка (Patch),
- $w_{window}, h_{window}$ - ширина и высота локального окна при расчёте SSIM
- $s$ — шаг окна (stride).

Количество позиций, в которых участок может быть сопоставлен с картой:
$$N = \left(\frac{W - w}{s} + 1\right) \times \left(\frac{H - h}{s} + 1\right)$$

Для каждой позиции требуется сравнить $w \times h$ пикселей (вычислить метрику SSIM).

Для каждого пикселя требуется просмотреть окно рядом стоящих пикселей $w_{window} \times h_{window}$

Итоговая асимптотическая сложность:
$$O\left(\frac{(W-w)\cdot(H-h)}{s^2} \cdot w h \cdot w_{window} \cdot h_{window}\right)$$

Если шаг $s=1$, то:
$$O\left((W-w)\cdot(H-h)\cdot w h \cdot w_{window} \cdot h_{window}\right)$$

**Пояснение:**
- На CPU все сравнения выполняются последовательно, поэтому время растёт линейно от количества позиций и размера окна.
- На GPU вычисления для разных позиций могут идти параллельно, что значительно ускоряет обработку.
